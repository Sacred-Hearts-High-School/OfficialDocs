<div class="hero-unit">

   <h1>上傳 csv 檔案</h1>

   <br /><br />
   <p>
   注意，匯入的 Excel 欄位，必須依照以下順序：<br />
   收文日期, 總收文, 發文機關, 文別, 發文字號, 事由, 組
   簽收人, 簽收日期, 歸檔日期。<br />
   且第一行為標題，會自動略過。
   </p>
   <p>
<%= form_tag 'import', :multipart=>true do %>
    <%= file_field_tag :file , accept: '.csv, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' %>
    <%= submit_tag "匯入檔案", class:'btn btn-primary' %>
<% end %>

</div>


<script>//<![CDATA[
$(function(){$.fn.bootstrapFileInput=function(){this.each(function(i,elem){var $elem=$(elem);if(typeof $elem.attr('data-bfi-disabled')!='undefined'){return;}
var buttonWord='選擇檔案';if(typeof $elem.attr('title')!='undefined'){buttonWord=$elem.attr('title');}
var input=$('<div>').append($elem.eq(0).clone()).html();var className='';if(!!$elem.attr('class')){className=' '+$elem.attr('class');}
$elem.replaceWith('<a class="file-input-wrapper btn'+className+'">'+buttonWord+input+'</a>');}).promise().done(function(){$('.file-input-wrapper').mousemove(function(cursor){var input,wrapper,wrapperX,wrapperY,inputWidth,inputHeight,cursorX,cursorY;wrapper=$(this);input=wrapper.find("input");wrapperX=wrapper.offset().left;wrapperY=wrapper.offset().top;inputWidth=input.width();inputHeight=input.height();cursorX=cursor.pageX;cursorY=cursor.pageY;moveInputX=cursorX-wrapperX-inputWidth+20;moveInputY=cursorY-wrapperY-(inputHeight/2);input.css({left:moveInputX,top:moveInputY});});$('.file-input-wrapper input[type=file]').change(function(){var fileName;fileName=$(this).val();$(this).parent().next('.file-input-name').remove();if(!!$(this).prop('files')&&$(this).prop('files').length>1){fileName=$(this)[0].files.length+' files';}
else{fileName=fileName.substring(fileName.lastIndexOf('\\')+1,fileName.length);}
$(this).parent().after('<span class="file-input-name">'+fileName+'</span>');});});};var cssHtml='<style>'+'.file-input-wrapper { overflow: hidden; position: relative; cursor: pointer; z-index: 1; }'+'.file-input-wrapper input[type=file], .file-input-wrapper input[type=file]:focus, .file-input-wrapper input[type=file]:hover { position: absolute; top: 0; left: 0; cursor: pointer; opacity: 0; filter: alpha(opacity=0); z-index: 99; outline: 0; }'+'.file-input-name { margin-left: 8px; }'+'</style>';$('link[rel=stylesheet]').eq(0).before(cssHtml);});
//]]></script>
<script>$(document).ready(function(){$('input[type=file]').bootstrapFileInput();});</script>
